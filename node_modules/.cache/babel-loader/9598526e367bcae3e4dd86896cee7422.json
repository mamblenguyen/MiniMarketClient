{"ast":null,"code":"var _s = $RefreshSig$();\n// useUser.js\nimport { useEffect, useState } from \"react\";\nimport { jwtDecode } from \"jwt-decode\";\nimport useAuth from \"./useAuth\";\nconst useUser = () => {\n  _s();\n  const [user, setUser] = useState(null);\n  const firebaseAuth = useAuth();\n  useEffect(() => {\n    var _firebaseAuth$user2;\n    const token = localStorage.getItem(\"accessToken\");\n    if (token) {\n      try {\n        const decoded = jwtDecode(token);\n        setUser({\n          id: decoded.id,\n          displayName: decoded.name,\n          email: decoded.email,\n          role: decoded.role,\n          slug: decoded.slug,\n          picture: decoded.picture\n        });\n      } catch (error) {\n        var _firebaseAuth$user;\n        console.warn(\"Invalid JWT token, trying Firebase user...\");\n        if ((_firebaseAuth$user = firebaseAuth.user) !== null && _firebaseAuth$user !== void 0 && _firebaseAuth$user.email) {\n          setUser({\n            id: null,\n            displayName: firebaseAuth.user.displayName,\n            email: firebaseAuth.user.email,\n            role: \"google_user\",\n            slug: null\n          });\n        } else {\n          setUser(null);\n        }\n      }\n    } else if ((_firebaseAuth$user2 = firebaseAuth.user) !== null && _firebaseAuth$user2 !== void 0 && _firebaseAuth$user2.email) {\n      // Không có token nhưng có user từ Firebase\n      setUser({\n        id: null,\n        displayName: firebaseAuth.user.displayName,\n        email: firebaseAuth.user.email,\n        role: \"google_user\",\n        slug: null\n      });\n    } else {\n      setUser(null);\n    }\n  }, [firebaseAuth.user]);\n  return user;\n};\n_s(useUser, \"8ILJnOyeU234nXvlUDH6EMs3qFw=\", false, function () {\n  return [useAuth];\n});\nexport default useUser;","map":{"version":3,"names":["useEffect","useState","jwtDecode","useAuth","useUser","_s","user","setUser","firebaseAuth","_firebaseAuth$user2","token","localStorage","getItem","decoded","id","displayName","name","email","role","slug","picture","error","_firebaseAuth$user","console","warn"],"sources":["D:/HocLapTrinh/ProjectBenXe/MiniMarketClient/src/hooks/useUser.js"],"sourcesContent":["// useUser.js\r\nimport { useEffect, useState } from \"react\";\r\nimport { jwtDecode } from \"jwt-decode\";\r\nimport useAuth from \"./useAuth\";\r\n\r\nconst useUser = () => {\r\n  const [user, setUser] = useState(null);\r\n  const firebaseAuth = useAuth();\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"accessToken\");\r\n    if (token) {\r\n      try {\r\n        const decoded = jwtDecode(token);\r\n        setUser({\r\n          id: decoded.id,\r\n          displayName: decoded.name,\r\n          email: decoded.email,\r\n          role: decoded.role,\r\n          slug: decoded.slug,\r\n          picture  :  decoded.picture\r\n        });\r\n      } catch (error) {\r\n        console.warn(\"Invalid JWT token, trying Firebase user...\");\r\n        if (firebaseAuth.user?.email) {\r\n          setUser({\r\n            id: null,\r\n            displayName: firebaseAuth.user.displayName,\r\n            email: firebaseAuth.user.email,\r\n            role: \"google_user\",\r\n            slug: null,\r\n          });\r\n        } else {\r\n          setUser(null);\r\n        }\r\n      }\r\n    } else if (firebaseAuth.user?.email) {\r\n      // Không có token nhưng có user từ Firebase\r\n      setUser({\r\n        id: null,\r\n        displayName: firebaseAuth.user.displayName,\r\n        email: firebaseAuth.user.email,\r\n        role: \"google_user\",\r\n        slug: null,\r\n      });\r\n    } else {\r\n      setUser(null);\r\n    }\r\n  }, [firebaseAuth.user]);\r\n\r\n  return user;\r\n};\r\n\r\nexport default useUser;\r\n"],"mappings":";AAAA;AACA,SAASA,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC3C,SAASC,SAAS,QAAQ,YAAY;AACtC,OAAOC,OAAO,MAAM,WAAW;AAE/B,MAAMC,OAAO,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACpB,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGN,QAAQ,CAAC,IAAI,CAAC;EACtC,MAAMO,YAAY,GAAGL,OAAO,CAAC,CAAC;EAE9BH,SAAS,CAAC,MAAM;IAAA,IAAAS,mBAAA;IACd,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,aAAa,CAAC;IACjD,IAAIF,KAAK,EAAE;MACT,IAAI;QACF,MAAMG,OAAO,GAAGX,SAAS,CAACQ,KAAK,CAAC;QAChCH,OAAO,CAAC;UACNO,EAAE,EAAED,OAAO,CAACC,EAAE;UACdC,WAAW,EAAEF,OAAO,CAACG,IAAI;UACzBC,KAAK,EAAEJ,OAAO,CAACI,KAAK;UACpBC,IAAI,EAAEL,OAAO,CAACK,IAAI;UAClBC,IAAI,EAAEN,OAAO,CAACM,IAAI;UAClBC,OAAO,EAAKP,OAAO,CAACO;QACtB,CAAC,CAAC;MACJ,CAAC,CAAC,OAAOC,KAAK,EAAE;QAAA,IAAAC,kBAAA;QACdC,OAAO,CAACC,IAAI,CAAC,4CAA4C,CAAC;QAC1D,KAAAF,kBAAA,GAAId,YAAY,CAACF,IAAI,cAAAgB,kBAAA,eAAjBA,kBAAA,CAAmBL,KAAK,EAAE;UAC5BV,OAAO,CAAC;YACNO,EAAE,EAAE,IAAI;YACRC,WAAW,EAAEP,YAAY,CAACF,IAAI,CAACS,WAAW;YAC1CE,KAAK,EAAET,YAAY,CAACF,IAAI,CAACW,KAAK;YAC9BC,IAAI,EAAE,aAAa;YACnBC,IAAI,EAAE;UACR,CAAC,CAAC;QACJ,CAAC,MAAM;UACLZ,OAAO,CAAC,IAAI,CAAC;QACf;MACF;IACF,CAAC,MAAM,KAAAE,mBAAA,GAAID,YAAY,CAACF,IAAI,cAAAG,mBAAA,eAAjBA,mBAAA,CAAmBQ,KAAK,EAAE;MACnC;MACAV,OAAO,CAAC;QACNO,EAAE,EAAE,IAAI;QACRC,WAAW,EAAEP,YAAY,CAACF,IAAI,CAACS,WAAW;QAC1CE,KAAK,EAAET,YAAY,CAACF,IAAI,CAACW,KAAK;QAC9BC,IAAI,EAAE,aAAa;QACnBC,IAAI,EAAE;MACR,CAAC,CAAC;IACJ,CAAC,MAAM;MACLZ,OAAO,CAAC,IAAI,CAAC;IACf;EACF,CAAC,EAAE,CAACC,YAAY,CAACF,IAAI,CAAC,CAAC;EAEvB,OAAOA,IAAI;AACb,CAAC;AAACD,EAAA,CA9CID,OAAO;EAAA,QAEUD,OAAO;AAAA;AA8C9B,eAAeC,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module"}